#!/usr/bin/env python

from patt_to_number import pattern_to_number
import sys
def computing_freq(seq,k):
    '''seq-Genomic sequence\
    k-k value for k-mer, The function returns the frequency array for k-mer patterns in the sequence'''
    for i in xrange(1,(4**k)+1):
        freq_array=[0]*i# or we could have simply used freq_array=[0]*(4**k)
    for i in xrange(len(seq)-k+1):#access all k-mers and count each of their occurence ...but notice we are walking over the sequence only once
        pattern=seq[i:i+k]
        j=pattern_to_number(pattern)
        freq_array[j]=freq_array[j]+1
    return freq_array
    #for i in xrange(4**k):
    #    print freq_array[i],
#genome=''
#fh=open(sys.argv[1],'r')
#for line in fh:
#    line=line.rstrip().strip('').upper()
#    genome=genome+line
#k=8
#computing_freq(genome,k)

#print computing_freq('CGGGTTGCCAAGTCACTGATGTTGCGGGTCTCGAACTCACTACGATACCCCGCCGGAGCCGAGGCGATTTTGGGTAGTTAGTTCAATAGCGCAAAGAGTTTCAGACTTCCTGTTCGTGAATACCCCTCATCATAACTGAACACTGGTATGCGCCAGACTTCTCTAATCCCCAAAGTTGGCGTTTTAAGTAAAGGATCGGGACGGTAGCAAATTGTAGCGTTCAGCAGCTTTAACAACTAAGAGCTTAAGGCACAAAGCCCTTACAAAGACGCATGTTCATGCCAACCAGTTCCTAAGCCACACCCAGAGTCGGAGAAGATTCACAACAGAACGTCTTCCCGCCGAACTCCTGAGGTCGAAAACGCGAAGACTAGCAGGTATAGCTACTCGACTTAATTGACGTTATTGCAGCTCAACATAAGCCAATGGCGACCTGGAAGCACGGCCCTACAGCCCTCCAAGTTTGTAGCGCCAAGACTGACACGTAGCAACTCGGGAAGTAAGGCCCGGGGCTGTGTCGATCAGGCACTCAAAGTAGATCTCAGCTACGGCGTTAATGCCGCGGAACGCACCCAGGCATGTAATGCGTTGTGAGTTGAGCGTAGAGTCCCGCAGTGGAGCCAATGACTCGGCGCACTGCTGGAACTGTACAGACTAGCGCTATGTCCGTATACCCGGGAGAGTTAAGTCTCTGGAACCAAGTATCAGTTCAAGAACCATAAACAGCACAGTGCTATATGTACTTTCCGACAGCACCCC',7)
#print computing_freq('ACTTCGCCTAAGTCATTTATCCCGTGGTACGACGCTCCCTTACAGTCTTATATCCCGGTATATACGCAGAAATGCCTACGTCCCCTCGTCCCACACACCAGGGAAGCTGAAATCGCTCATCTACTATGCGTGTACTTCCGGACGAAATCGTCGTCGGCTTCTGTCTGGCGCTGGAGATCCGGGCTTCTTGAGGGACACACCCATTATGACCGTTACAGGACTTACAACTACTCTGAGCAATGATGGTGCTCTGTAACGAACAAACGCACTCACCTCTGTTTCCTGTATGACATCCTCAAATGGATCGACCGTGATGTACTGAGCGAATAAGTGCGGATTACATTTATAGTCAGCTACATTTATTCGCCGCTCGGAGCAGAGTATAATGAATTTATACCACTTGTTAGACTCCTTCTCGCATTTAGCCCCTACCGCAAGTCGGAGCGTTGGGGTGCAATAGAGTTTTCAGTATCTACGTACCGTTAAGTCTCTCGCGTTCTTTCAGCAGGCATCAATATGTTGCTTGCTGTGGGGTCGGGTGGGGCGGAGAGCCAATAAAGTGCATCGGAATTGGCTGCCCTCCTACGAATCCGCAAGATGCGGTGATGCTACGTGATTATGACTACTAGCTTAGTCCC',6)    
#print computing_freq(''ACTTCGCCTAAGTCATTTATCCCGTGGTACGACGCTCCCTTACAGTCTTATATCCCGGTATATACGCAGAAATGCCTACGTCCCCTCGTCCCACACACCAGGGAAGCTGAAATCGCTCATCTACTATGCGTGTACTTCCGGACGA\
#AATCGTCGTCGGCTTCTGTCTGGCGCTGGAGATCCGGGCTTCTTGAGGGACACACCCATTATGACCGTTACAGGACTTACAACTACTCTGAGCAATGATGGTGCTCTGTAACGAACAAACGCACTCACCTCTGTTTCCTGTATGACATCCTCAAATGGATCGACCGT\
#GATGTACTGAGCGAATAAGTGCGGATTACATTTATAGTCAGCTACATTTATTCGCCGCTCGGAGCAGAGTATAATGAATTTATACCACTTGTTAGACTCCTTCTCGCATTTAGCCCCTACCGCAAGTCGGAGCGTTGGGGTGCAATAGAGTTTTCAGTATCTACGTA\
#CCGTTAAGTCTCTCGCGTTCTTTCAGCAGGCATCAATATGTTGCTTGCTGTGGGGTCGGGTGGGGCGGAGAGCCAATAAAGTGCATCGGAATTGGCTGCCCTCCTACGAATCCGCAAGATGCGGTGATGCTACGTGATTATGACTACTAGCTTAGTCCC',6)
#print computing_freq('TAAAGGTGACGCGCAACCTTGTTGTAGGGAACTACGAATTTAGAAGAGCGTTGCCCCCCGCGCATTGCTAGGCAGTGGATGGCGCAGAATGATGCTCTTGCAAGGTTGGCACACGTCGAGTCAACGGCCCTTCGGAGTAGTCGCGGTCTGAGGTCAATATATAAGGATGCTCCACCGCGAATAATGCGCAGTGTATTCGCCTGACGCATAGAGCATGCCATTGGCAAACCCACCAGTTATCCTGCAATAGGACGGCACGCGAAAGCACCACCAGGGAACTTCGGTCAAAGCACAGCTATTCAGTCCTTTGGTGCTGTGACCCCAAGGCCACGCAGATCCGCAACCTCGAAAACCGAAGTAATGAGGTTTTTATTTGATCTCGGCCCTGTCCAGAACCACCCACCATTCGACCATCTCTACCATAGACTCTTTTCTAGAACTCGAACCGAAGATGTTAAAGTTAGTAGATATACAGGCTCGCTGGTGGACGGTACTGCGAAAGATTCTTGAGATTACTACCCTTACACCCTTACCTGCTCGACGCGGGTAATGAATGTTGTTTCCTTCTCGCGCGGCTCGTGCCCGAGATGGGTTCACACCACCCTTATAACAGAAGATCAGGACCTCCGAGAATAGGGCAGAACTATCATCATATC',5)
#print computing_freq('GAACTAGGTCCCGATAGAAGGCCCATGCGGTCCAACCAGAGCGTGTCGTGTCCCTGTTCTTGCCACGGACGTATAGTTAATAAAAGTGAAGTGTTCTCGTCCCGATGTTGTCTTTGTGGACCGGTCATGTCTGCGCGTCCGTTACCTATGAGACTCTGTTGCTGGGCGCTGTCGCCTCATTCGAAACCCCTGAGTAGTATAGCGTGACTCCCGACAACATTAGCAGTGATCGCTCTCGGCGTCTACGATCATCGAGATTTTCTAGACGTGGCCTCTCGAACTTAGAGGCTTGCACTTCAGTGTAGAGAAATCCCTCGCCCGCTAATACACCGGTTTGCGCTCCCAACGAGAATGCAAGCCAACAGTCAAGGACTCCAGTCTTTGCAGAAGGACCAGTAGTATAGTAGACTGGACACTGTCAACTAGGCCCAGCCCAACTGGGTACCCGGGAATCCCAGTTACGTTTCTGCACAAATCTGAAGTACCTCAATGACGTTAAGGGGTCTGGGGTGGTCACGCAGCGCGCGCTCCAGCAATACGATAACCCGACCATAAGAGATACAGTTCGTCGCGCACACATGTCGCGTCAGCGGTCTGCAGCGACTAATTCGTTTGGCGGCTCTCAGCAGCTGATTAGACTTGGACGGGACAACTGCGTAAAGATCGTCCAGTTATATCCTCTATCAAGATCGTATAACTTCGATACGCCCTTACTCTTCCTGG',8)
